/*[CDN]*/!function(e,t){if("function"==typeof define&&define.amd)define([],t);else if("undefined"!=typeof exports)t();else{t(),e.FileSaver={}}}(this,function(){"use strict";var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0;function d(e,t,o){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){a(n.response,t,o)},n.onerror=function(){console.error("could not download file")},n.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&t.status<=299}function l(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(o)}}var u=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(e,t,o){var n=f.URL||f.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin!==location.origin?r(a.href)?d(e,t,o):l(a,a.target="_blank"):l(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){l(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,o){if(t=t||e.name||"download","string"==typeof e)if(r(e))d(e,t,o);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){l(n)})}else navigator.msSaveOrOpenBlob((a=e,void 0===(i=o)?i={autoBom:!1}:"object"!=typeof i&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a),t);var a,i}:function(e,t,o,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return d(e,t,o);var a="application/octet-stream"===e.type,i=/constructor/i.test(f.HTMLElement)||f.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||a&&i||u)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var e=l.result;e=r?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},l.readAsDataURL(e)}else{var s=f.URL||f.webkitURL,c=s.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){s.revokeObjectURL(c)},4e4)}});f.saveAs=a.saveAs=a,"undefined"!=typeof module&&(module.exports=a)});;
!function(r){var t={};try{t=JSON.parse(localStorage.getItem("jj")||"{}")}catch(t){}new Vue({el:"#app",data:Object.assign({user:"",pass:"",infoUrl:"",cookie:"",tip:"",chapter:[],author:"",title:"",intro:"",checkAll:!0,downing:!1,sortDesc:!1},t||{}),computed:{},watched:{infoUrl:function(){this.reset()}},methods:{reset:function(){this.tip="",this.chapter=[],this.author="",this.title="",this.intro=""},selectAll:function(){this.chapter.map(function(t,e){return t.checked=!t.checked,t}),this.checkAll=checked},loadChapter:function(){var e=this;e.downing=!0;var t={user:e.user,pass:e.pass,infoUrl:e.infoUrl,cookie:e.cookie};localStorage.setItem("jj",JSON.stringify(t)),r.API.post("jj_info",t,function(t){e.downing=!1,0<t.error?e.tip=t.data:(e.tip=(t.extend.tip||[]).join("\n"),e.chapter=t.extend.chapter.map(function(t){return t.checked=!0,t.content="",t.tip="",t}),e.title=t.extend.title,e.author=t.extend.author,e.intro=t.extend.intro,e.cookie=t.extend.cookie,e.isover=t.extend.isover,e.cover=t.extend.cover)})},downChapter:function(){var i=this,t=0;function c(){var t="";t=i.title+" - "+i.author+"\n\n",t+=i.intro+"\n\n";for(var e=0;e<i.chapter.length;e++){var n=i.chapter[e];n.checked&&(t+="☆、"+n.name+"\n\n",t+=n.content+"\n\n")}try{var o=new Blob([t],{type:"text/plain;charset=utf-8"});saveAs(o,i.title.replace(/\s+/gi,"_")+".txt")}catch(t){alert("您的浏览器不支持下载："+t.message)}}i.downing=!0,function e(){for(var n=t;n<i.chapter.length;n++){var o=i.chapter[n];if(o.checked&&!o.content)return t=n,void r.API.post("jj_chapter",{url:o.link,cookie:i.cookie},function(t){0<t.error?(i.chapter[n].tip='<font color=red><i class="weui-icon weui-icon-warn"></i>下载失败:'+t.data+"</font>",alert(o.name+":下载失败, "+t.data),i.downing=!1):(i.chapter[n].content=t.extend.content,i.chapter[n].tip='<font color=#006400><i class="weui-icon weui-icon-success"></i>下载成功，约 '+t.extend.content.length+' 字</font> <font color="blue">[点击查看]</font>',e())})}i.downing=!1,toast("正在打包下载中...","loading",3e3,function(){setTimeout(function(){i.$nextTick(c)},200)})}()},showContent:function(t){if(t.content)return alert('<div id="read-chapter-txt" style="height:450px;width:100%;overflow-y: auto;line-height:1.6;text-align:left">'+t.content.replace(/\n/gi,"<br>")+"</div>",{title:""}),r.event.stopPropagation(),!1},loginTip:function(t){alert('<div class="text-left">[我们不会保存您的账号信息]<BR><BR>1. 每小时只能在本系统里登录一次，登录成功后请不要去 JJ 登录，<font color="red">否则无法正常下载 VIP 章节</font><BR>2. 下载前请先订阅要下载的章节，程序不会自动订阅</div>')},sort:function(){this.sortDesc=!this.sortDesc}}})}(window,document);;
